{% extends 'base.html' %}

{% block content %}
<div class="container">
    <h1>Make Payment</h1>

    <div class="card">
        <h2>{{ fee_structure.name }}</h2>
        <p><strong>Description:</strong> {{ fee_structure.description }}</p>
        <p><strong>Amount:</strong> <span style="font-size: 24px; color: var(--primary-color); font-weight: bold;">${{ fee_structure.amount }}</span></p>
        <p><strong>Due Date:</strong> {{ fee_structure.due_date }}</p>
    </div>

    <form method="POST" id="paymentForm">
        {% csrf_token %}
        <div>
            <label for="payment_method">Payment Method:</label>
            <select id="payment_method" name="payment_method" required>
                <option value="online">Online Payment</option>
                <option value="bank_transfer">Bank Transfer</option>
                <option value="credit_card">Credit Card</option>
                <option value="debit_card">Debit Card</option>
            </select>
        </div>

        <div style="margin-top: 15px;">
            <label for="account_number">Account Number: *</label>
            <input type="text" id="account_number" name="account_number" required 
                   placeholder="Enter 9-18 digit account number" 
                   pattern="[0-9]{9,18}" 
                   title="Account number should be 9-18 digits">
        </div>

        <div style="margin-top: 15px;">
            <label for="ifsc_code">IFSC Code: *</label>
            <input type="text" id="ifsc_code" name="ifsc_code" required 
                   placeholder="e.g., SBIN0001234" 
                   maxlength="11"
                   style="text-transform: uppercase;"
                   title="IFSC code should be 11 characters (e.g., SBIN0001234)">
        </div>

        <button type="submit" class="btn" style="margin-top: 20px;">Proceed to Payment</button>
        <a href="{% url 'view_student_fees' %}" class="btn btn-secondary" style="margin-top: 20px;">Cancel</a>
    </form>

    <script>
    document.getElementById('paymentForm').addEventListener('submit', function(e) {
        const accountNumber = document.getElementById('account_number').value.trim();
        const ifscCode = document.getElementById('ifsc_code').value.trim().toUpperCase();
        
        if (!accountNumber || !ifscCode) {
            e.preventDefault();
            alert('Please fill in all required fields');
            return false;
        }
        
        if (!/^\d{9,18}$/.test(accountNumber)) {
            e.preventDefault();
            alert('Invalid Account Number. It should be 9-18 digits');
            return false;
        }
        
        if (ifscCode.length !== 11) {
            e.preventDefault();
            alert('Invalid IFSC Code. It should be exactly 11 characters');
            return false;
        }
    });
    </script>
</div>
{% endblock %}
